# –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ XLS —Ñ–∞–π–ª—ñ–≤ Monobank

## –û–≥–ª—è–¥

–î–æ–¥–∞–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥—É XLS —Ñ–∞–π–ª—ñ–≤ –≤—ñ–¥ Monobank. –¶–µ –¥–æ–ø–æ–≤–Ω—é—î —ñ—Å–Ω—É—é—á—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É CSV —Ñ–∞–π–ª—ñ–≤ –≤—ñ–¥ Monobank.

## –ù–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### 1. –ü–∞—Ä—Å–∏–Ω–≥ XLS —Ñ–∞–π–ª—ñ–≤ Monobank

- **–§–∞–π–ª**: `services/statement_parser.py`
- **–ú–µ—Ç–æ–¥**: `_parse_monobank_xls()`
- **–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏**: `.xls` —Ç–∞ `.xlsx`

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏

–ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:

- –®—É–∫–∞—î —Ä—è–¥–æ–∫ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ —É —Ñ–∞–π–ª—ñ
- –†–æ–∑–ø—ñ–∑–Ω–∞—î –∫–æ–ª–æ–Ω–∫–∏ –∑–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–∏–º–∏ –Ω–∞–∑–≤–∞–º–∏
- –û–±—Ä–æ–±–ª—è—î —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ –¥–∞—Ç —Ç–∞ —á–∞—Å—É
- –ü–∞—Ä—Å–∏—Ç—å —Å—É–º–∏ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –∑–Ω–∞–∫—É (–¥–æ—Ö—ñ–¥/–≤–∏—Ç—Ä–∞—Ç–∞)

### 3. –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏

–ü–∞—Ä—Å–µ—Ä —Ä–æ–∑–ø—ñ–∑–Ω–∞—î —Ç–∞–∫—ñ —Ç–∏–ø–∏ –∫–æ–ª–æ–Ω–æ–∫:

- **–î–∞—Ç–∞**: –∫–æ–ª–æ–Ω–∫–∏ –∑ "–¥–∞—Ç–∞" —É –Ω–∞–∑–≤—ñ
- **–ß–∞—Å**: –∫–æ–ª–æ–Ω–∫–∏ –∑ "—á–∞—Å" —É –Ω–∞–∑–≤—ñ
- **–û–ø–∏—Å**: "–¥–µ—Ç–∞–ª—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó", "–æ–ø–∏—Å"
- **–°—É–º–∞**: "—Å—É–º–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó", "—Å—É–º–∞ –≤ –≤–∞–ª—é—Ç—ñ –∫–∞—Ä—Ç–∫–∏"
- **MCC**: –∫–æ–¥ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –£ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç—ñ

1. –í–∏–±–µ—Ä—ñ—Ç—å "üì§ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–∏–ø–∏—Å–∫—É"
2. –û–±–µ—Ä—ñ—Ç—å "üü° Monobank"
3. –í–∏–±–µ—Ä—ñ—Ç—å "üìä Excel —Ñ–∞–π–ª (.xls/.xlsx)"
4. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ XLS —Ñ–∞–π–ª –≤—ñ–¥ Monobank

### –ü—Ä–æ–≥—Ä–∞–º–Ω–æ

```python
from services.statement_parser import StatementParser

parser = StatementParser()
transactions = parser._parse_monobank_xls("path/to/monobank.xls")

for transaction in transactions:
    print(f"{transaction['date']} - {transaction['amount']} - {transaction['description']}")
```

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö

### –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ (XLS —Ñ–∞–π–ª)

–û—á—ñ–∫—É—î—Ç—å—Å—è XLS —Ñ–∞–π–ª –∑ —Ç–∞–∫–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏:

- –î–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- –ß–∞—Å –æ–ø–µ—Ä–∞—Ü—ñ—ó (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- –î–µ—Ç–∞–ª—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó / –û–ø–∏—Å
- –°—É–º–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó (–∑ –∑–Ω–∞–∫–æ–º: + –¥–ª—è –¥–æ—Ö–æ–¥—ñ–≤, - –¥–ª—è –≤–∏—Ç—Ä–∞—Ç)
- MCC –∫–æ–¥ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

### –í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ

–ö–æ–∂–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —è–∫ —Å–ª–æ–≤–Ω–∏–∫:

```python
{
    'date': '2025-06-20',           # –î–∞—Ç–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ YYYY-MM-DD
    'time': '14:30:00',             # –ß–∞—Å —É —Ñ–æ—Ä–º–∞—Ç—ñ HH:MM:SS
    'amount': 150.00,               # –°—É–º–∞ (–∑–∞–≤–∂–¥–∏ –¥–æ–¥–∞—Ç–Ω–∞)
    'description': '–ü–æ–∫—É–ø–∫–∞ –≤ –º–∞–≥–∞–∑–∏–Ω—ñ', # –û–ø–∏—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
    'type': 'expense',              # 'income' –∞–±–æ 'expense'
    'source': 'monobank_xls'        # –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö
}
```

## –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫

–ü–∞—Ä—Å–µ—Ä –æ–±—Ä–æ–±–ª—è—î —Ç–∞–∫—ñ —Å–∏—Ç—É–∞—Ü—ñ—ó:

- –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ–∑–∏—Ü—ñ—ó –∫–æ–ª–æ–Ω–æ–∫
- –ù–µ–≤—ñ—Ä–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ –¥–∞—Ç - –ø—Ä–æ–ø—É—Å–∫–∞—î —Ä—è–¥–∫–∏
- –ù–µ–≤—ñ—Ä–Ω—ñ —Å—É–º–∏ - –ø—Ä–æ–ø—É—Å–∫–∞—î —Ä—è–¥–∫–∏
- –ü–æ—Ä–æ–∂–Ω—ñ —Ä—è–¥–∫–∏ - —ñ–≥–Ω–æ—Ä—É—î
- –ö—ñ–ª—å–∫–∞ –∞—Ä–∫—É—à—ñ–≤ - –æ–±—Ä–æ–±–ª—è—î –≤—Å—ñ

## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç:

```bash
python test_monobank_xls.py
```

–î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ñ–∞–π–ª `data/test_monobank.xls`.

## –õ–æ–≥—É–≤–∞–Ω–Ω—è

–ü–∞—Ä—Å–µ—Ä –≤–µ–¥–µ –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏:

- –ó–Ω–∞–π–¥–µ–Ω—ñ –∞—Ä–∫—É—à—ñ
- –†–æ–∑–ø—ñ–∑–Ω–∞–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
- –ü–æ–º–∏–ª–∫–∏ –æ–±—Ä–æ–±–∫–∏

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- `pandas` - –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏
- `re` - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥—É –¥–∞—Ç —Ç–∞ —Å—É–º
- `datetime` - –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞—Ç–∞–º–∏

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

1. **–ü–æ—à—É–∫ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤**: –ü–µ—Ä–µ–≤—ñ—Ä—è—î –ø–µ—Ä—à—ñ 20 —Ä—è–¥–∫—ñ–≤ —Ñ–∞–π–ª—É
2. **–†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –∫–æ–ª–æ–Ω–æ–∫**: –ó–∞ –∫–ª—é—á–æ–≤–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –ø–æ—Ç—ñ–º –∑–∞ –ø–æ–∑–∏—Ü—ñ—î—é
3. **–ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç**: –ü—ñ–¥—Ç—Ä–∏–º—É—î —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ –¥–∞—Ç
4. **–û–±—Ä–æ–±–∫–∞ —Å—É–º**: –í–∏–¥–∞–ª—è—î –≤–∞–ª—é—Ç–Ω—ñ —Å–∏–º–≤–æ–ª–∏ —Ç–∞ —Ä–æ–∑–¥—ñ–ª—é–≤–∞—á—ñ

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –±–æ—Ç–æ–º

–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑:

1. `parse_bank_statement()` - –æ—Å–Ω–æ–≤–Ω–∏–π –º–µ—Ç–æ–¥ –ø–∞—Ä—Å–∏–Ω–≥—É
2. `message_handler.py` - –æ–±—Ä–æ–±–∫–∞ —Ñ–∞–π–ª—ñ–≤ —É –±–æ—Ç—ñ
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–∏–ø—É –±–∞–Ω–∫—É
